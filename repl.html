<html>
<head>
<script type="text/javascript" src="lib/json2.js"></script>
<script type="text/javascript" src="lib/jsparse.js"></script>
<script type="text/javascript" src="lisp.js"></script>
<script type="text/javascript" src="lisp-rt.js"></script>
<script type="text/javascript">
function lisp_repl_print(output)
{
    var element = document.createElement("div");
    element.innerHTML = output;
    document.getElementById("output").appendChild(element);
}

function lisp_repl()
{
    var input = document.getElementById("input").value
    lisp_repl_print(lisp_eval(lisp_read(input)));
}

function lisp_repl_onload()
{
    lisp_repl_print("Fetching boot.lisp...");
    var req = new XMLHttpRequest();
    req.open("GET", "lisp/boot.lisp", false);
    req.send(null);
    lisp_repl_print("Evaluating boot.lisp...");
    if(req.status == 200) {
        lisp_eval(lisp_read(req.responseText));
    } else {
        lisp_error("XHR error", req.status);
    }
    lisp_repl_print("Lisp ready");
}
</script>
</head>
<body onload="lisp_repl_onload()">
<div id="output"></div>
<form action="javascript:lisp_repl()">
<input type="text" id="input" value="(defun double (x) (* x 2))" style="width: 23em">
<input type="submit" value="evaluate">
</form>
</body>
</html>
